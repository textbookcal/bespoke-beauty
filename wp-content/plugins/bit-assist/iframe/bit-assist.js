!function(){"use strict";const t=window?.bit_assist_?.api?.base||"http://bit-assist-wp.test/wp-json/bit-assist/v1",i=window?.bit_assist_?.api?.base?`${bit_assist_.api.base}/iframe`:"http://localhost:5000",e=new URL(i).origin,o=window?.bit_assist_?.api?.separator||"?",n="http:"===window.location.protocol?"i":"s",s="localhost"===window.location.hostname?window.location.host:window.location.hostname,a=window.location.href,d=document.documentElement.offsetWidth,c=window.innerHeight;let r="100px",h="100px",l=0;const w=`\n\t#bit-assist-widget-container{--ba-top:auto;--ba-left:auto;--ba-bottom:10;--ba-right:10;position:fixed;z-index:2147483646;bottom:0;right:0;width:${h};height:${r};max-width:100%}\n\t#bit-assist-widget-container.bottom-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n\t#bit-assist-widget-container.bottom-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n\t#bit-assist-widget-container.top-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n\t#bit-assist-widget-container.top-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n\t#bit-assist-widget-iframe{width:100%;height:100%;border:none;}\n\t.bit-assist-hide{visibility:hidden;pointer-events:none}\n\t`,u=document.createElement("style");u.appendChild(document.createTextNode(w));const f=document.createElement("div");f.id="bit-assist-widget-container",W();const p=document.createElement("iframe");function b(t,i=!1){const e=window.scrollY,o=document.body.offsetHeight,n=window.innerHeight,s=Math.round(e/(o-n)*100);if(!i)return s;!l&&s>=i?(l=1,m(s)):l&&s<i&&(l=0,m(s))}function m(t){p.contentWindow.postMessage({action:"scrollPercent",scrollPercent:t},e)}function g(t,i){h=t+"px",r=i+"px",Object.assign(f.style,{width:h,height:r})}p.title="wp-bit-assist",p.src=`${i}${o}clientDomain=${n}-protocol-bit-assist-${s}`,p.id="bit-assist-widget-iframe",p.setAttribute("allowfullscreen",""),p.setAttribute("scrolling","no"),f.appendChild(p),document.body.append(u,f),document.addEventListener("click",(t=>{f.classList.contains("bit-assist-open")&&!t.target.closest("#bit-assist-widget-container")&&p.contentWindow.postMessage({action:"clickOutside"},e)})),window.addEventListener("message",(i=>{if(i.origin!==e)return;const{action:o}=i.data;if("getClientInfo"===o){const i=b();p.contentWindow.postMessage({action:"windowLoaded",url:a,winWidth:d,winHeight:c,scrollPercent:i,apiEndPoint:t},e)}else if("widgetLoaded"===o){const{height:t,width:e,position:o,top:n,bottom:s,left:a,right:d,pageScroll:c}=i.data;!function(t,i,e,o,n){t.indexOf("top")>-1&&f.style.setProperty("--ba-top",i+"px");t.indexOf("bottom")>-1&&f.style.setProperty("--ba-bottom",e+"px");t.indexOf("left")>-1&&f.style.setProperty("--ba-left",o+"px");t.indexOf("right")>-1&&f.style.setProperty("--ba-right",n+"px")}(o,n,s,a,d),f.classList.remove("bit-assist-hide"),f.classList.add(o),g(e,t),c>0&&window.addEventListener("scroll",(t=>b(0,c)))}else if("widgetOpen"===o){_()&&1==Tawk_API?.isChatMaximized()&&Tawk_API?.minimize();const{isWidgetOpen:t}=i.data;f.classList.toggle("bit-assist-open",t)}else if("removeWidget"===o)f.remove(),u.remove();else if("resetWidgetSize"===o){const{height:t,width:e}=i.data;g(e,t)}else if("chatWidgetClick"===o){const{chatWidgetName:t}=i.data;!function(t){E(),"tawk"===t&&function(){if(!v)return $("Tawk"),null;try{Tawk_API=Tawk_API||{},Tawk_API.showWidget(),Tawk_API.toggle(),W()}catch(t){$("Tawk"),L()}}();"live-chat-messenger"===t&&function(){if(!A)return $("Messenger"),null;try{(window.FB||{}).CustomerChat.showDialog(),W()}catch(t){$("Messenger"),L()}}();"crisp"===t&&function(){if(!C)return $("Crisp"),null;try{const t=window.$crisp||{};t.push(["do","chat:show"]),t.push(["do","chat:toggle"]),W()}catch{$("Crisp"),L()}}();"intercom"===t&&function(){if(!I)return $("Intercom"),null;try{Intercom=Intercom||{},Intercom("show"),W()}catch(t){$("Intercom"),L()}}();"tidio"===t&&function(){if(!y)return $("Tidio"),null;try{tidioChatApi=tidioChatApi||{},tidioChatApi.open(),tidioChatApi.show(),W()}catch(t){$("Tawk"),L()}}()}(t)}else if("bitAssistChannelClick"===o){const{channelInfo:t}=i.data;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"bitAssistChannel",...t})}})),window.addEventListener("load",(()=>{k()&&function(){const t=window.FB?.CustomerChat||{};t.hide(),FB.Event.subscribe("customerchat.load",(function(){A=!0,t.hide()})),FB.Event.subscribe("customerchat.show",(function(){W()})),FB.Event.subscribe("customerchat.hide",(function(){L()})),FB.Event.subscribe("customerchat.dialogShow",(function(){W()})),FB.Event.subscribe("customerchat.dialogHide",(function(){t.hide()}))}(),_()&&(Tawk_API=Tawk_API||{},Tawk_API.onLoad=function(){v=!0,Tawk_API.hideWidget()},Tawk_API.onChatMinimized=function(){Tawk_API.hideWidget(),L()}),P()&&function(){const t=window.$crisp||{};C=!0,t.push(["do","chat:hide"]),t.push(["on","chat:closed",function(){t.push(["do","chat:hide"]),L()}])}(),T()&&(I=!0,Intercom("update",{hide_default_launcher:!0}),Intercom("onShow",(function(){W()})),Intercom("onHide",(function(){L()}))),x()&&(tidioChatApi.hide(),tidioChatApi.on("ready",(function(){y=!0,tidioChatApi.hide()})),tidioChatApi.on("close",(function(){L(),tidioChatApi.hide()})))}));var v=!1,A=!1,y=!1,C=!1,I=!1;function _(){return"undefined"!=typeof Tawk_API}function k(){return void 0!==window.FB}function P(){return"undefined"!=typeof $crisp}function T(){return"undefined"!=typeof Intercom}function x(){return"undefined"!=typeof tidioChatApi}function L(){f.classList.remove("bit-assist-hide"),E()}function E(){_()&&Tawk_API?.minimize(),k()&&FB?.CustomerChat?.hide(),P()&&$crisp?.push(["do","chat:hide"]),T()&&Intercom("hide"),x()&&tidioChatApi.hide()}function W(){f.classList.add("bit-assist-hide")}function $(t){return alert(`Sorry, ${t} is not loaded yet!`)}}();
